---
title: "Adding Equus to bacollite"
author: "Simon Hickinbotham"
date: "14/01/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


NCBI Reference Sequence: XP_023508478.1 is as follows: 

```
>XP_023508478.1 collagen alpha-1(I) chain [Equus caballus]
MFSFVDLRLLLLLAATALLTHGQEEGQEEGQEEDIPAVTCIQDGLRYHDRAVWKPEPCRVCICDNGNVLC
DDVICEDTKNCPGASVPKDECCPVCPEGQVSPTDDQTTGVEGPKGDTGPRGPRGPAGPPGRDGIPGQPGL
PGPPGPPGPPGPPGLGGNFAP


QLSYGYDEKSAGISVPGPMGPSGPRGLPGPPGAPGPQGFQGPPGEPGEP
GASGPMGPRGPPGPPGKNGDDGEAGKPGRPGERGPPGPQGARGLPGTAGLPGMKGHRGFSGLDGAKGDAG
PAGPKGEPGSPGENGAPGQMGPRGLPGERGRPGAPGPAGARGNDGATGAAGPPGPTGPAGPPGFPGAVGA
KGEAGPQGARGSEGPQGVRGEPGPPGPAGAAGPAGNPGADGQPGAKGANGAPGIAGAPGFPGARGPSGPQ
GPSGPPGPKGNSGEPGAPGNKGDTGAKGEPGPTGIQGPPGPAGEEGKRGARGEPGPTGLPGPPGERGGPG
ARGFPGADGVAGPKGPAGERGAPGPAGPKGSPGEAGRPGEAGLPGAKGLTGSPGSPGPDGKTGPPGPAGQ
DGRPGPPGPPGARGQAGVMGFPGPKGAAGEPGKAGERGVPGPPGAVGPAGKDGEAGAQGPPGPAGPAGER
GEQGPAGSPGFQGLPGPAGPPGESGKPGEQGVPGDLGAPGPSGARGERGFPGERGVQGPPGPAGPRGSNG
APGNDGAKGDAGAPGAPGSQGAPGLQGMPGERGAAGLPGPKGDRGDAGPKGADGSPGKDGVRGLTGPIGP
PGPAGAPGDKGETGPSGPAGPTGARGAPGDRGEPGPPGPAGFAGPPGADGQPGAKGEPGDAGAKGDAGPP
GPAGPAGPPGPIGSVGAPGPKGARGSAGPPGATGFPGAAGRVGPPGPSGNAGPPGPPGPVGKEGGKGPRG
ETGPAGRPGEAGPPGPPGPAGEKGSPGADGPAGAPGTPGPQGIAGQRGVVGLPGQRGERGFPGLPGPSGE
PGKQGPSGASGERGPPGPVGPPGLAGPPGESGREGSPGAEGSPGRDGSPGPKGDRGETGPAGPPGAPGAP
GAPGPVGPAGKSGDRGEAGPAGPAGPIGPVGARGPAGPQGPRGDKGETGEQGDRGIKGHRGFSGLQGPPG
PPGSPGEQGPSGASGPAGPRGPPGSAGAPGKDGLNGLPGPIGPPGPRGRTGDAGPVGPPGPPGPPGPPGP
PSGGFDFSFLPQPPQEKSHDGGRYYRA


DDANVVRDRDLEVDTTLKSLSQQIENIRSPEGSRKNPARTCRD
LKMCHSDWKSGEYWIDPNQGCNLDAIKVFCNMETGETCVYPTQPQVAQKNWYISKNPKDKRHVWYGESMT
DGFQFEYGGQGSDPADVAIQLTFLRLMSTEASQNITYHCKNSVAYMDQQTGNLKKALLLQGSNEIEIRAE
GNSRFTYSVTYDGCTSHTGAWGKTVIEYKTTKTSRLPIIDVAPLDIGAPDQEFGIDIGPVCFL

```


and Col1a2 is : 

```
>XP_001492989.1 collagen alpha-2(I) chain [Equus caballus]
MLSFVDTRTLLLLAVTSCLATCQSLQEATAGKGPTGDRGPRGERGPPGPPGRDGDDGIPGPPGPPGPPGP
PGLGGNFAA

QFDAKGGGPGPMGLMGPRGPPGASGAPGPQGFQGPAGEPGEPGQTGPAGARGPPGPPGKAG
EDGHPGKPGRPGERGVVGPQGARGFPGTPGLPGFKGIRGHNGLDGLKGQPGAPGVKGEPGAPGENGTPGQ
AGARGLPGERGRVGAPGPAGARGSDGSVGPVGPAGPIGSAGPPGFPGAPGPKGELGPVGNPGPAGPAGPR
GEVGLPGLSGPVGPPGNPGANGLTGAKGAAGLPGVAGAPGLPGPRGIPGPAGAAGATGARGLVGEPGPAG
SKGESGNKGEPGAAGPQGPPGPSGEEGKRGPNGEPGSTGPAGPPGLRGSPGSRGLPGADGRAGVMGPAGS
RGASGPAGVRGPNGDSGRPGEPGLMGPRGFPGSPGNIGPAGKEGPVGLPGIDGRPGPIGPAGARGEPGNI
GFPGPKGPSGEPGKPGDKGHAGLAGARGAPGPDGNNGAQGPPGPQGVQGGKGEQGPAGPPGFQGLPGPAG
TAGEVGKPGERGLPGEFGLPGPAGARGERGPPGESGAAGPAGPIGSRGPSGPPGPDGNKGEPGVLGAPGT
AGPSGPSGLPGERGAAGIPGGKGEKGETGLRGEIGNPGRDGARGAPGAVGAPGPAGANGDRGEAGAAGPA
GPAGPRGSPGERGEVGPAGPNGFAGPAGAAGQPGAKGERGTKGPKGENGPVGPTGPVGAAGPSGPNGPPG
PAGSRGDGGPPGVTGFPGAAGRTGPPGPSGISGPPGPPGAAGKEGLRGPRGDQGPVGRAGETGASGPPGF
AGEKGPSGEPGTAGPPGTPGPQGLLGAPGILGLPGSRGERGLPGVAGSLGEPGPLGIAGPPGARGPPGAV
GAPGVNGAPGEAGRDGNPGSDGPPGRDGQPGHKGERGYPGNAGPVGAVGAPGPHGPVGPTGKHGHRGEPG
PVGSVGPVGAVGPRGPSGPQGVRGDKGEPGDKGPRGLPGIKGHNGLQGLPGLAGQHGDQGAPGSVGPAGP
RGPAGPTGPVGKDGRSGQPGTVGPAGVRGSQGSQGPAGPPGPPGPPGPPGPSGGGYDFGYDGDFYRA

DQP
RSPPSLRPKDYEVDATLKSLNNQIETLLTPEGSRKNPARTCRDLRLSHPEWSSGYYWIDPNQGCTMDAIK
VYCDFSTGETCIRAQPENIPAKNWYRSSKAKKHIWLGETINGGTQFEYNVEGVTTKEMATQLAFMRLLAN
HASQNITYHCKNSIAYLDEETGNLKKAVTLQGSNDVELVAEGNSRFTYTVLVDGCSRKTNEWGKTIIEYK
TNKPSRLPILDIALLDIGGADQEFGLDIGPVCFK
```

We can follow the guidance for adding deer sequences in the vignette "SI_Aligning_Samples_To_Peptides" 

The first step is to combine the two collagen sequences into one: 

```{r}
eqseq <- "QLSYGYDEKSAGISVPGPMGPSGPRGLPGPPGAPGPQGFQGPPGEPGEPGASGPMGPRGPPGPPGKNGDDGEAGKPGRPGERGPPGPQGARGLPGTAGLPGMKGHRGFSGLDGAKGDAGPAGPKGEPGSPGENGAPGQMGPRGLPGERGRPGAPGPAGARGNDGATGAAGPPGPTGPAGPPGFPGAVGAKGEAGPQGARGSEGPQGVRGEPGPPGPAGAAGPAGNPGADGQPGAKGANGAPGIAGAPGFPGARGPSGPQGPSGPPGPKGNSGEPGAPGNKGDTGAKGEPGPTGIQGPPGPAGEEGKRGARGEPGPTGLPGPPGERGGPGARGFPGADGVAGPKGPAGERGAPGPAGPKGSPGEAGRPGEAGLPGAKGLTGSPGSPGPDGKTGPPGPAGQDGRPGPPGPPGARGQAGVMGFPGPKGAAGEPGKAGERGVPGPPGAVGPAGKDGEAGAQGPPGPAGPAGERGEQGPAGSPGFQGLPGPAGPPGESGKPGEQGVPGDLGAPGPSGARGERGFPGERGVQGPPGPAGPRGSNGAPGNDGAKGDAGAPGAPGSQGAPGLQGMPGERGAAGLPGPKGDRGDAGPKGADGSPGKDGVRGLTGPIGPPGPAGAPGDKGETGPSGPAGPTGARGAPGDRGEPGPPGPAGFAGPPGADGQPGAKGEPGDAGAKGDAGPPGPAGPAGPPGPIGSVGAPGPKGARGSAGPPGATGFPGAAGRVGPPGPSGNAGPPGPPGPVGKEGGKGPRGETGPAGRPGEAGPPGPPGPAGEKGSPGADGPAGAPGTPGPQGIAGQRGVVGLPGQRGERGFPGLPGPSGEPGKQGPSGASGERGPPGPVGPPGLAGPPGESGREGSPGAEGSPGRDGSPGPKGDRGETGPAGPPGAPGAPGAPGPVGPAGKSGDRGEAGPAGPAGPIGPVGARGPAGPQGPRGDKGETGEQGDRGIKGHRGFSGLQGPPGPPGSPGEQGPSGASGPAGPRGPPGSAGAPGKDGLNGLPGPIGPPGPRGRTGDAGPVGPPGPPGPPGPPGPPSGGFDFSFLPQPPQEKSHDGGRYYRAQFDAKGGGPGPMGLMGPRGPPGASGAPGPQGFQGPAGEPGEPGQTGPAGARGPPGPPGKAGEDGHPGKPGRPGERGVVGPQGARGFPGTPGLPGFKGIRGHNGLDGLKGQPGAPGVKGEPGAPGENGTPGQAGARGLPGERGRVGAPGPAGARGSDGSVGPVGPAGPIGSAGPPGFPGAPGPKGELGPVGNPGPAGPAGPRGEVGLPGLSGPVGPPGNPGANGLTGAKGAAGLPGVAGAPGLPGPRGIPGPAGAAGATGARGLVGEPGPAGSKGESGNKGEPGAAGPQGPPGPSGEEGKRGPNGEPGSTGPAGPPGLRGSPGSRGLPGADGRAGVMGPAGSRGASGPAGVRGPNGDSGRPGEPGLMGPRGFPGSPGNIGPAGKEGPVGLPGIDGRPGPIGPAGARGEPGNIGFPGPKGPSGEPGKPGDKGHAGLAGARGAPGPDGNNGAQGPPGPQGVQGGKGEQGPAGPPGFQGLPGPAGTAGEVGKPGERGLPGEFGLPGPAGARGERGPPGESGAAGPAGPIGSRGPSGPPGPDGNKGEPGVLGAPGTAGPSGPSGLPGERGAAGIPGGKGEKGETGLRGEIGNPGRDGARGAPGAVGAPGPAGANGDRGEAGAAGPAGPAGPRGSPGERGEVGPAGPNGFAGPAGAAGQPGAKGERGTKGPKGENGPVGPTGPVGAAGPSGPNGPPGPAGSRGDGGPPGVTGFPGAAGRTGPPGPSGISGPPGPPGAAGKEGLRGPRGDQGPVGRAGETGASGPPGFAGEKGPSGEPGTAGPPGTPGPQGLLGAPGILGLPGSRGERGLPGVAGSLGEPGPLGIAGPPGARGPPGAVGAPGVNGAPGEAGRDGNPGSDGPPGRDGQPGHKGERGYPGNAGPVGAVGAPGPHGPVGPTGKHGHRGEPGPVGSVGPVGAVGPRGPSGPQGVRGDKGEPGDKGPRGLPGIKGHNGLQGLPGLAGQHGDQGAPGSVGPAGPRGPAGPTGPVGKDGRSGQPGTVGPAGVRGSQGSQGPAGPPGPPGPPGPPGPSGGGYDFGYDGDFYRA"
```




```{r}
require(bacollite)
eqpep <- parse.seq(eqseq,max.missed.cleaves = 1)
```



NB the equus peptide is "SGQP....!



```{r}
require(knitr, quietly = 0)
dp1 <- eqpep[eqpep$seqpos>1972 & eqpep$seqpos<2002 & eqpep$nglut == 0 & (eqpep$nhyd == 0 | eqpep$nhyd == 1) & eqpep$missed.cleaves == 0,]
```

```
seqpos 1997
sheep                  TGQPGAVGPAGIR
goat                   TGQPGAVGPAGIR
calf                   IGQPGAVGPAGIR
horse GHNGLQGLPGLAGQHGDQGAPGSVGPAGPR 
```

```{r}
require(knitr, quietly = 0)
dp1 <- eqpep[eqpep$seqpos>592 & eqpep$seqpos<612 & eqpep$nglut == 0 & (eqpep$nhyd == 0 | eqpep$nhyd == 1) & eqpep$missed.cleaves == 0,]
```

```
seqpos 602
```
 
hmm - this is more complicated than I'd hoped! Perhaps the best I can do for now is see how the horse spectrum fares 
 
 In an ideal world, we'd 


# How to load some peptides

There are several sets of petide sequence that come with bacollite, but here we'll just use some simple ones to demonstrate the process. The bacollite package comes with some sets of peptides that we can use to descriminate between samples from sheep, cow and goat, as described in paper [1] in the README file. lets have a look at these files. The peptides in `dm_sheep` are:


```{r echo=FALSE, message=FALSE, warning=FALSE}
require(knitr)
kable(dm_sheep)
```

Those in `dm_cow` are: 

```{r echo=FALSE}
kable(dm_cow)
```


...and those in `dm_goat` are: 

```{r echo=FALSE}
kable(dm_goat)
```


## Generating deer peptides. 

This section shows how you would add another species set of markers, using peptides with the same collagen position and hydroxylation level as the sheep/cow/goat peptides shown above. Here we have a concatenated sequence for deer collagen 1A1 and 1A2 (**todo: note where this sequence has come from**):

```
GPMGPSGPRGIPGPPGAPGPQGFQGPPGEPGEPGASGPMGPRGPPGPPGKNGDDGEAGKPGRPGERGPPGPQGARGIPGTAGIPGMKXXXGFSGI
DGAKGDAGPAGPKGEPGSPGENGAPGQMGPRXXXXXXGRPGAPGPAGARGNDGATGAAGPPGPTGPAGPPGFPGAVGAKGEAGPQGPRGSEGPQG
VRGEPGPPGPAGAAGPAGNPGADGQPGAKGANGAPGIAGAPGFPGARGPSGPQGPSGPPGPKGNSGEPGAPGSKGDTGAKGEPGPTGIQGPPGPA
GEEGKRXXXGEPGPAGIPGPPGERXXXXXXGFPGADGVAGPKGPAGERGSPGPAGPKGSPGEAGRPGEAGIPGAKGITGSPGSPGPDGKTGPPGP
AGQDGRPGPPGPPGARGQAGVMGFPGPKGAAGEPGKAGERGVPGPPGAVGPAGKDGEAGAQGPPGPAGPAGERGEQGPAGSPGFQGIPGPAGPPG
EAGKPGEQGVPGDIGAPGPSGARXXXXXXXXXGVQGPPGPAGPRGANGAPGNDGAKGDAGAPGAPGSQGAPGIQGMPGERGAAGIPGPKGDRGDA
GPKGADGAPGKDGVRGITGPIGPPGPAGAPGDKGETGPSGPAGPTGARGAPGDRGEPGPPGPAGFAGPPGADGQPGAKXXXXXXXXXGDAGPPGP
AGPAGPPGPIGNVGAPGPKXXXGSAGPPGATGFPGAAGRVGPPGPSGNAGPPGPPGPAGKXXXXXXRGETGPAGRPGEVGPPGPPGPAGEKGAPG
ADGPAGAPGTPGPQGIAGQRGVVGIPGQRXXXGFPGIPGPSGEPGKQGPSGASGERGPPGPMGPPGIAGPPGESGREGAPGAEGSPGRDGSPGPK
GDRGETGPAGPPGAPGAPGAPGPVGPAGKSGDRGETGPAGPAGPIGPVGARGPAGPQGPRGDKGETGEQGDRXXXXXXGFSGIQGPPGPPGSPGE
QGPSGASGPAGPRGPPGSAGTPGKDGINGIPGPIGPPGPRXXTGDAGPAGPPGPPGPPGPPGPPKGPMGIMGPRGPPGASGAPGPQGFQGPPGEP
GEPGQTGPAGARXXXXXXXXAGEDGHPGKPGRPGERGVVGPQGARGFPGTPGIPGFKXXXGHNGIDGIKGQPGAPGVKGEPGAPGENGTPGQTGA
RXXXXXXGRVGAPGPAGARGSDGSVGPVGPAGPIGSAGPPGFPGAPGPKGEIGPVGNPGPAGPAGPRGEVGIPGISGPVGPPGNPGANGIPGAKG
AAGIPGVAGAPGIPGPRGIPGPVGAAGATGARGIVGEPGPAGSKGESGNKGEPGAVGQPGPPGPSGEEGKRGSTGEIGPAGPPGPPGIRXXXXXX
XXXXXXXXAGVMGPAGSRXXXXXXXXXGPNGDSGRPGEPGIMGPRGFPGSPGNIGPAGKEGPVGIPGIDGRPGPIGPAGARGEPGNIGFPGPKGP
TGDPGKAGEKGHAGIAGARXXXXXXXXXXXXXXXXXXXXXXXXGEQGPAGPPGFQGIPGPAGTAGEAGKPGERGIPGEFGIPGPAGARXXXGPPG
ESGAAGPAGPIGSRGPSGPPGPDGNKGEPGVVGAPGTAGPSGPSGIPGERGAAGIPGGKGEKGETGIRXXXXXXXXXXXXGAPGAVGAPGPAGAN
GDRGEAGPAGPAGPAGPRXXXXXXGEVGPAGPNGFAGPAGAAGQPGAKGERXXXGPKGENGPVGPTGPVGAAGPSGPNGPPGPAGSRGDGGPPGA
TGFPGAAGRTGPPGPSGISGPPGPPGPAGKEGIRGPRGDQGPVGRTGETGASGPPGFAGEKGPSGEPGTAGPPGTPGPQGIIGPPGFIGIPGSRX
XXGIPGVAGSVGEPGPIGIAGPPGARGPPGNVGNPGVNGAPGEAGRDGNPGNDGPPGRDGQPGHKGERGYPGNAGPVGTAGAPGPQGPVGPTGKH
GNRGEPGPAGAVGPAGAVGPRGPSGPQGIRGDKGEPGDKGPRGIPGIKGHNGIQGIPGIAGHHGDQGAPGAVGPAGPRGPAGPSGPAGKDGRTGQ
PGAVGPAGIRGSQGSQGPAGPPGPPGPPGPPGPS
```

We can load this sequence into an R variable like this: 

```{r}
deerseq <- "GPMGPSGPRGIPGPPGAPGPQGFQGPPGEPGEPGASGPMGPRGPPGPPGKNGDDGEAGKPGRPGERGPPGPQGARGIPGTAGIPGMKXXXGFSGIDGAKGDAGPAGPKGEPGSPGENGAPGQMGPRXXXXXXGRPGAPGPAGARGNDGATGAAGPPGPTGPAGPPGFPGAVGAKGEAGPQGPRGSEGPQGVRGEPGPPGPAGAAGPAGNPGADGQPGAKGANGAPGIAGAPGFPGARGPSGPQGPSGPPGPKGNSGEPGAPGSKGDTGAKGEPGPTGIQGPPGPAGEEGKRXXXGEPGPAGIPGPPGERXXXXXXGFPGADGVAGPKGPAGERGSPGPAGPKGSPGEAGRPGEAGIPGAKGITGSPGSPGPDGKTGPPGPAGQDGRPGPPGPPGARGQAGVMGFPGPKGAAGEPGKAGERGVPGPPGAVGPAGKDGEAGAQGPPGPAGPAGERGEQGPAGSPGFQGIPGPAGPPGEAGKPGEQGVPGDIGAPGPSGARXXXXXXXXXGVQGPPGPAGPRGANGAPGNDGAKGDAGAPGAPGSQGAPGIQGMPGERGAAGIPGPKGDRGDAGPKGADGAPGKDGVRGITGPIGPPGPAGAPGDKGETGPSGPAGPTGARGAPGDRGEPGPPGPAGFAGPPGADGQPGAKXXXXXXXXXGDAGPPGPAGPAGPPGPIGNVGAPGPKXXXGSAGPPGATGFPGAAGRVGPPGPSGNAGPPGPPGPAGKXXXXXXRGETGPAGRPGEVGPPGPPGPAGEKGAPGADGPAGAPGTPGPQGIAGQRGVVGIPGQRXXXGFPGIPGPSGEPGKQGPSGASGERGPPGPMGPPGIAGPPGESGREGAPGAEGSPGRDGSPGPKGDRGETGPAGPPGAPGAPGAPGPVGPAGKSGDRGETGPAGPAGPIGPVGARGPAGPQGPRGDKGETGEQGDRXXXXXXGFSGIQGPPGPPGSPGEQGPSGASGPAGPRGPPGSAGTPGKDGINGIPGPIGPPGPRXXTGDAGPAGPPGPPGPPGPPGPPKGPMGIMGPRGPPGASGAPGPQGFQGPPGEPGEPGQTGPAGARXXXXXXXXAGEDGHPGKPGRPGERGVVGPQGARGFPGTPGIPGFKXXXGHNGIDGIKGQPGAPGVKGEPGAPGENGTPGQTGARXXXXXXGRVGAPGPAGARGSDGSVGPVGPAGPIGSAGPPGFPGAPGPKGEIGPVGNPGPAGPAGPRGEVGIPGISGPVGPPGNPGANGIPGAKGAAGIPGVAGAPGIPGPRGIPGPVGAAGATGARGIVGEPGPAGSKGESGNKGEPGAVGQPGPPGPSGEEGKRGSTGEIGPAGPPGPPGIRXXXXXXXXXXXXXXAGVMGPAGSRXXXXXXXXXGPNGDSGRPGEPGIMGPRGFPGSPGNIGPAGKEGPVGIPGIDGRPGPIGPAGARGEPGNIGFPGPKGPTGDPGKAGEKGHAGIAGARXXXXXXXXXXXXXXXXXXXXXXXXGEQGPAGPPGFQGIPGPAGTAGEAGKPGERGIPGEFGIPGPAGARXXXGPPGESGAAGPAGPIGSRGPSGPPGPDGNKGEPGVVGAPGTAGPSGPSGIPGERGAAGIPGGKGEKGETGIRXXXXXXXXXXXXGAPGAVGAPGPAGANGDRGEAGPAGPAGPAGPRXXXXXXGEVGPAGPNGFAGPAGAAGQPGAKGERXXXGPKGENGPVGPTGPVGAAGPSGPNGPPGPAGSRGDGGPPGATGFPGAAGRTGPPGPSGISGPPGPPGPAGKEGIRGPRGDQGPVGRTGETGASGPPGFAGEKGPSGEPGTAGPPGTPGPQGIIGPPGFIGIPGSRXXXGIPGVAGSVGEPGPIGIAGPPGARGPPGNVGNPGVNGAPGEAGRDGNPGNDGPPGRDGQPGHKGERGYPGNAGPVGTAGAPGPQGPVGPTGKHGNRGEPGPAGAVGPAGAVGPRGPSGPQGIRGDKGEPGDKGPRGIPGIKGHNGIQGIPGIAGHHGDQGAPGAVGPAGPRGPAGPSGPAGKDGRTGQPGAVGPAGIRGSQGSQGPAGPPGPPGPPGPPGPS"
```

Then we can generate all the peptides we see if we digested the sequence with trypsin like this:

```{r}
deerpep <- parse.seq(deerseq,max.missed.cleaves = 1)
```

Note here that we are generating all peptides with up to 1 missed cleave here. OK, that gives us a set of all peptides possible from Deer. We can find the sequences by looking at the `seqpos` variable for the other species, and looking for a peptide in that vicinity. We want peptides that correspond to the positions in the collagen that we used in the sheep cow goat study: 


```{r}
require(knitr, quietly = T)
kable(dm_sheep)
```




The sheep peptide with masses at 1180 and 1196 has a seqpos value of 1997, so let's list the deer peptides with a seqpos in a range around that value: 






```{r}
require(knitr, quietly = 0)
dp1 <- deerpep[deerpep$seqpos>1992 & deerpep$seqpos<2002 & deerpep$nglut == 0 & (deerpep$nhyd == 0 | deerpep$nhyd == 1) & deerpep$missed.cleaves == 0,]
kable(dp1)
```

Great, it looks like we've found it, and the sequence is identical to sheep. 

Let's repeat the procedure for the seqpos around 1776: 


```{r}
require(knitr, quietly = 0)
dp2 <- deerpep[deerpep$seqpos>1771 & deerpep$seqpos<1781 & deerpep$nglut == 0 & (deerpep$nhyd == 4 | deerpep$nhyd == 5) & deerpep$missed.cleaves == 0,]
kable(dp2)
```

OK, the final peptide has a missed cleave, so it's a bit more tricky to create. First, let's find the peptide 



```{r}
require(knitr, quietly = 0)
dp3 <- deerpep[deerpep$seqpos>585 & deerpep$seqpos<595 & deerpep$nglut == 0 & (deerpep$nhyd == 2) & deerpep$missed.cleaves == 1,]
kable(dp3)
```




Now we can make the set of deer peptides (note we are putting them in the same order as the sheep peptides at this point)

```{r}
dm_deer <- rbind(dp1,dp3,dp2)
kable(dm_deer)
```

# How do horse and cat score agains 'get your goat' peptides??


